/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 11:00:02,466 - src.utils.file_paths - INFO - Read mc_config.ini successful
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 145, in <module>
    logger.info(f'PROCESS RUN TIMESTAMP...........................................................................: {datetime.now()}\n')
Message: 'PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 11:00:02.466709\n'
Arguments: ()
2023-12-26 11:00:02,466 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 11:00:02.466709

--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 150, in <module>
    logger.info(f'Stop date is set for: {stop_date}\n')
Message: 'Stop date is set for: 2023/12/26\n'
Arguments: ()
2023-12-26 11:00:02,467 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 153, in <module>
    app_data = access_app_data('r', logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/file_paths.py", line 27, in access_app_data
    config = read_config(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/file_paths.py", line 58, in read_config
    logger_instance.info("Read mc_config.ini successful")
Message: 'Read mc_config.ini successful'
Arguments: ()
2023-12-26 11:00:02,468 - etl_daily_log - INFO - Read mc_config.ini successful
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 153, in <module>
    app_data = access_app_data('r', logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/file_paths.py", line 32, in access_app_data
    logger_instance.info("Loading app data from JSON file.")
Message: 'Loading app data from JSON file.'
Arguments: ()
2023-12-26 11:00:02,468 - etl_daily_log - INFO - Loading app data from JSON file.
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 155, in <module>
    logger.info(f'Start date is set for: {start_date}\n')
Message: 'Start date is set for: 2023/12/24\n'
Arguments: ()
2023-12-26 11:00:02,468 - etl_daily_log - INFO - Start date is set for: 2023/12/24

--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 157, in <module>
    config = read_config(logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/file_paths.py", line 58, in read_config
    logger_instance.info("Read mc_config.ini successful")
Message: 'Read mc_config.ini successful'
Arguments: ()
2023-12-26 11:00:02,469 - etl_daily_log - INFO - Read mc_config.ini successful
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 36, in get_google_credentials
    logger_instance.warning("Failed to obtain valid creddentials")
Message: 'Failed to obtain valid creddentials'
Arguments: ()
2023-12-26 11:00:02,471 - etl_daily_log - WARNING - Failed to obtain valid creddentials
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 39, in get_google_credentials
    logger_instance.info("Trying to refresh credentials...")
Message: 'Trying to refresh credentials...'
Arguments: ()
2023-12-26 11:00:02,471 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 11:00:02,472 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 11:00:02,473 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa027593b50>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-26 11:00:12,495 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 63, in read_email
    logger_instance.info("Retrieving email(s)")
Message: 'Retrieving email(s)'
Arguments: ()
2023-12-26 11:00:12,498 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 11:00:12,501 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 11:00:12,501 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/httplib2/__init__.py", line 1366, in _conn_request
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/httplib2/__init__.py", line 1142, in connect
    address_info = socket.getaddrinfo(host, port, 0, socket.SOCK_STREAM)
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google_auth_httplib2.py", line 119, in __call__
    response, data = self.http.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/httplib2/__init__.py", line 1724, in request
    (response, content) = self._request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/httplib2/__init__.py", line 1444, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/httplib2/__init__.py", line 1373, in _conn_request
    raise ServerNotFoundError("Unable to find the server at %s" % conn.host)
httplib2.error.ServerNotFoundError: Unable to find the server at oauth2.googleapis.com

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 65, in read_email
    result = service.users().messages().list(userId='me',q=query).execute()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google_auth_httplib2.py", line 209, in request
    self.credentials.before_request(self._request, method, uri, request_headers)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/credentials.py", line 135, in before_request
    self.refresh(request)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google_auth_httplib2.py", line 126, in __call__
    raise exceptions.TransportError(exc)
google.auth.exceptions.TransportError: Unable to find the server at oauth2.googleapis.com

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 100, in read_email
    logger_instance.error(f"Error while reading email: {e}")
Message: 'Error while reading email: Unable to find the server at oauth2.googleapis.com'
Arguments: ()
2023-12-26 11:00:22,593 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 34, in extract_mc_transaction
    for email_entry in email_data:
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 55, in extract_mc_transaction
    logger_instance.error(f"Rescheduling process due to error retrieving email data:\n{e}")
Message: "Rescheduling process due to error retrieving email data:\n'NoneType' object is not iterable"
Arguments: ()
2023-12-26 11:00:22,600 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 34, in extract_mc_transaction
    for email_entry in email_data:
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 60, in extract_mc_transaction
    reschedule_cron_job(SYS_USER, job_comment, schedule, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/workflow.py", line 19, in reschedule_cron_job
    logger_instance.info(f"The '{job.comment}' cron job has been successfully reset as follows:\n{job}")
Message: "The 'etl_daily' cron job has been successfully reset as follows:\n0 12 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily"
Arguments: ()
2023-12-26 11:00:22,623 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 12 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
Exception ignored in atexit callback: <function shutdown at 0x7fa02ae7fa30>
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 2182, in shutdown
    h.flush()
TypeError: 'bool' object is not callable
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 13, in <module>
    logger = mc_logger(log_name='etl_daily_log', log_level='DEBUG', log_file='etl_daily.log')
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/my_logging.py", line 39, in mc_logger
    config = read_config()
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/file_paths.py", line 67, in read_config
    logger_instance.info("Read mc_config.ini successful")
Message: 'Read mc_config.ini successful'
Arguments: ()
2023-12-26 12:00:02,664 - read_config_log - INFO - Read mc_config.ini successful
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 145, in <module>
    logger.info(f'PROCESS RUN TIMESTAMP...........................................................................: {datetime.now()}\n')
Message: 'PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 12:00:02.665697\n'
Arguments: ()
2023-12-26 12:00:02,665 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 12:00:02.665697

--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 150, in <module>
    logger.info(f'Stop date is set for: {stop_date}\n')
Message: 'Stop date is set for: 2023/12/26\n'
Arguments: ()
2023-12-26 12:00:02,666 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 153, in <module>
    app_data = access_app_data('r', logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/file_paths.py", line 27, in access_app_data
    config = read_config(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/file_paths.py", line 67, in read_config
    logger_instance.info("Read mc_config.ini successful")
Message: 'Read mc_config.ini successful'
Arguments: ()
2023-12-26 12:00:02,667 - etl_daily_log - INFO - Read mc_config.ini successful
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 153, in <module>
    app_data = access_app_data('r', logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/file_paths.py", line 32, in access_app_data
    logger_instance.info("Loading app data from JSON file.")
Message: 'Loading app data from JSON file.'
Arguments: ()
2023-12-26 12:00:02,667 - etl_daily_log - INFO - Loading app data from JSON file.
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 155, in <module>
    logger.info(f'Start date is set for: {start_date}\n')
Message: 'Start date is set for: 2023/12/24\n'
Arguments: ()
2023-12-26 12:00:02,668 - etl_daily_log - INFO - Start date is set for: 2023/12/24

--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 157, in <module>
    config = read_config(logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/file_paths.py", line 67, in read_config
    logger_instance.info("Read mc_config.ini successful")
Message: 'Read mc_config.ini successful'
Arguments: ()
2023-12-26 12:00:02,669 - etl_daily_log - INFO - Read mc_config.ini successful
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 36, in get_google_credentials
    logger_instance.warning("Failed to obtain valid creddentials")
Message: 'Failed to obtain valid creddentials'
Arguments: ()
2023-12-26 12:00:02,672 - etl_daily_log - WARNING - Failed to obtain valid creddentials
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 39, in get_google_credentials
    logger_instance.info("Trying to refresh credentials...")
Message: 'Trying to refresh credentials...'
Arguments: ()
2023-12-26 12:00:02,672 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 12:00:02,673 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 12:00:02,675 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-26 12:00:04,390 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 42, in get_google_credentials
    logger_instance.info("Credentials refreshed successfully.\n")
Message: 'Credentials refreshed successfully.\n'
Arguments: ()
2023-12-26 12:00:04,394 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-26 12:00:04,400 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 63, in read_email
    logger_instance.info("Retrieving email(s)")
Message: 'Retrieving email(s)'
Arguments: ()
2023-12-26 12:00:04,405 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 12:00:04,412 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 34, in extract_mc_transaction
    for email_entry in email_data:
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 55, in extract_mc_transaction
    logger_instance.error(f"Rescheduling process due to error retrieving email data:\n{e}")
Message: "Rescheduling process due to error retrieving email data:\n'NoneType' object is not iterable"
Arguments: ()
2023-12-26 12:00:06,494 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 34, in extract_mc_transaction
    for email_entry in email_data:
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
TypeError: 'bool' object is not callable
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 60, in extract_mc_transaction
    reschedule_cron_job(SYS_USER, job_comment, schedule, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/workflow.py", line 19, in reschedule_cron_job
    logger_instance.info(f"The '{job.comment}' cron job has been successfully reset as follows:\n{job}")
Message: "The 'etl_daily' cron job has been successfully reset as follows:\n0 13 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily"
Arguments: ()
2023-12-26 12:00:06,524 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 13 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
Exception ignored in atexit callback: <function shutdown at 0x7f9c7417fa30>
Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 2182, in shutdown
    h.flush()
TypeError: 'bool' object is not callable
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 13:00:02,517 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 13:00:02,517 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 13:00:02.517235

2023-12-26 13:00:02,517 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 13:00:02,517 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 13:00:02,518 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 13:00:02,518 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 13:00:02,518 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 13:00:02,519 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 13:00:02,520 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 13:00:02,520 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 13:00:02,521 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-26 13:00:04,413 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2023-12-26 13:00:04,417 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-26 13:00:04,422 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 13:00:04,426 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 13:00:04,434 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 13:00:06,304 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 13:00:06,338 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 14 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 14:00:02,284 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 14:00:02,284 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 14:00:02.284528

2023-12-26 14:00:02,284 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 14:00:02,285 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 14:00:02,285 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 14:00:02,285 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 14:00:02,285 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 14:00:02,287 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 14:00:02,287 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 14:00:02,287 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 14:00:02,288 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-26 14:00:04,241 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2023-12-26 14:00:04,244 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-26 14:00:04,248 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 14:00:04,251 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 14:00:04,256 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 14:00:06,080 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 14:00:06,113 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 15 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 15:00:01,928 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 15:00:01,928 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 15:00:01.928873

2023-12-26 15:00:01,929 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 15:00:01,929 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 15:00:01,929 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 15:00:01,929 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 15:00:01,930 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 15:00:01,931 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 15:00:01,931 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 15:00:01,931 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 15:00:01,932 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-26 15:00:03,525 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2023-12-26 15:00:03,529 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-26 15:00:03,535 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 15:00:03,540 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 15:00:03,549 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 15:00:05,178 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 15:00:05,212 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 16 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 16:00:02,034 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 16:00:02,034 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 16:00:02.034702

2023-12-26 16:00:02,034 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 16:00:02,035 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 16:00:02,035 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 16:00:02,035 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 16:00:02,035 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 16:00:02,037 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 16:00:02,037 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 16:00:02,037 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 16:00:02,038 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-26 16:00:03,691 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2023-12-26 16:00:03,695 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-26 16:00:03,700 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 16:00:03,706 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 16:00:03,713 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 16:00:05,542 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 16:00:05,577 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 17 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 17:00:02,422 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 17:00:02,423 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 17:00:02.423024

2023-12-26 17:00:02,423 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 17:00:02,423 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 17:00:02,423 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 17:00:02,423 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 17:00:02,424 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 17:00:02,425 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 17:00:02,425 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 17:00:02,426 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 17:00:02,427 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-26 17:00:03,828 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2023-12-26 17:00:03,830 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-26 17:00:03,832 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 17:00:03,833 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 17:00:03,837 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 17:01:04,902 - etl_daily_log - ERROR - Error while reading email: The read operation timed out
2023-12-26 17:01:04,902 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 17:01:04,919 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 18 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 18:00:01,777 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 18:00:01,777 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 18:00:01.777880

2023-12-26 18:00:01,777 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 18:00:01,778 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 18:00:01,778 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 18:00:01,778 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 18:00:01,778 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 18:00:01,780 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 18:00:01,780 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 18:00:01,780 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 18:00:01,781 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f031f3fd480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-26 18:00:08,051 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 18:00:08,053 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 18:00:08,056 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 18:00:08,056 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 18:00:14,367 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-26 18:00:14,367 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 18:00:14,404 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 19 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 19:00:02,151 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 19:00:02,152 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 19:00:02.152017

2023-12-26 19:00:02,152 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 19:00:02,152 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 19:00:02,152 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 19:00:02,152 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 19:00:02,152 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 19:00:02,154 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 19:00:02,154 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 19:00:02,154 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 19:00:02,155 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff264201660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-26 19:00:08,384 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 19:00:08,390 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 19:00:08,398 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 19:00:08,398 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 19:00:14,687 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-26 19:00:14,687 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 19:00:14,724 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 20 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 20:00:02,225 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 20:00:02,225 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 20:00:02.225487

2023-12-26 20:00:02,225 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 20:00:02,226 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 20:00:02,226 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 20:00:02,226 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 20:00:02,226 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 20:00:02,227 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 20:00:02,227 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 20:00:02,228 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 20:00:02,229 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6cfbdfd180>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-26 20:00:08,512 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 20:00:08,518 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 20:00:08,527 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 20:00:08,527 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 20:00:14,895 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-26 20:00:14,895 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 20:00:14,931 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 21 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 21:00:01,861 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 21:00:01,862 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 21:00:01.862267

2023-12-26 21:00:01,862 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 21:00:01,862 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 21:00:01,863 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 21:00:01,863 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 21:00:01,863 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 21:00:01,865 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 21:00:01,866 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 21:00:01,866 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 21:00:01,868 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f51adb012d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-26 21:00:08,100 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 21:00:08,102 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 21:00:08,105 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 21:00:08,105 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 21:00:14,415 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-26 21:00:14,415 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 21:00:14,437 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 22 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 22:00:03,235 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 22:00:03,236 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 22:00:03.235991

2023-12-26 22:00:03,236 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 22:00:03,236 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 22:00:03,236 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 22:00:03,237 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 22:00:03,238 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 22:00:03,240 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 22:00:03,240 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 22:00:03,241 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 22:00:03,242 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc7192f4f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-26 22:00:13,288 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 22:00:13,295 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 22:00:13,301 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 22:00:13,302 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 22:00:23,454 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-26 22:00:23,455 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 22:00:23,487 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 23 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-26 23:00:02,330 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-26 23:00:02,331 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-26 23:00:02.331117

2023-12-26 23:00:02,331 - etl_daily_log - INFO - Stop date is set for: 2023/12/26

2023-12-26 23:00:02,331 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 23:00:02,331 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-26 23:00:02,332 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-26 23:00:02,332 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-26 23:00:02,333 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-26 23:00:02,334 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-26 23:00:02,334 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-26 23:00:02,335 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-26 23:00:08,604 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2023-12-26 23:00:08,610 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-26 23:00:08,617 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-26 23:00:08,623 - etl_daily_log - INFO - Retrieving email(s)
2023-12-26 23:00:08,631 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F26+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-26 23:00:20,331 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-26 23:00:20,368 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
@daily . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-27 00:00:01,837 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-27 00:00:01,838 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-27 00:00:01.837974

2023-12-27 00:00:01,838 - etl_daily_log - INFO - Stop date is set for: 2023/12/27

2023-12-27 00:00:01,838 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-27 00:00:01,838 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-27 00:00:01,839 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-27 00:00:01,839 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-27 00:00:01,842 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-27 00:00:01,842 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-27 00:00:01,843 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-27 00:00:01,845 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-27 00:00:17,347 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2023-12-27 00:00:17,351 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-27 00:00:17,355 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-27 00:00:17,364 - etl_daily_log - INFO - Retrieving email(s)
2023-12-27 00:00:17,377 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F27+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-27 00:00:29,642 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-27 00:00:29,684 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 1 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-27 01:00:01,884 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-27 01:00:01,884 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-27 01:00:01.884853

2023-12-27 01:00:01,885 - etl_daily_log - INFO - Stop date is set for: 2023/12/27

2023-12-27 01:00:01,885 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-27 01:00:01,886 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-27 01:00:01,886 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-27 01:00:01,887 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-27 01:00:01,888 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-27 01:00:01,888 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-27 01:00:01,889 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-27 01:00:01,890 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-27 01:00:07,959 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2023-12-27 01:00:07,960 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-27 01:00:07,963 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-27 01:00:07,965 - etl_daily_log - INFO - Retrieving email(s)
2023-12-27 01:00:07,969 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F27+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-27 01:00:22,459 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-27 01:00:22,481 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 2 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-27 02:00:02,530 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-27 02:00:02,530 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-27 02:00:02.530611

2023-12-27 02:00:02,530 - etl_daily_log - INFO - Stop date is set for: 2023/12/27

2023-12-27 02:00:02,531 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-27 02:00:02,531 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-27 02:00:02,531 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-27 02:00:02,531 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-27 02:00:02,533 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-27 02:00:02,533 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-27 02:00:02,534 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-27 02:00:02,535 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2023-12-27 02:00:08,663 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2023-12-27 02:00:08,665 - etl_daily_log - INFO - Credentials refreshed successfully.

2023-12-27 02:00:08,667 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-27 02:00:08,669 - etl_daily_log - INFO - Retrieving email(s)
2023-12-27 02:00:08,671 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F27+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-27 02:00:20,348 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-27 02:00:20,365 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 3 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-28 03:50:35,812 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-28 03:50:35,814 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-28 03:50:35.814176

2023-12-28 03:50:35,814 - etl_daily_log - INFO - Stop date is set for: 2023/12/28

2023-12-28 03:50:35,814 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-28 03:50:35,815 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-28 03:50:35,816 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-28 03:50:35,817 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-28 03:50:35,819 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-28 03:50:35,819 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-28 03:50:35,819 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-28 03:50:35,820 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7f209014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-28 03:50:45,861 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-28 03:50:45,869 - etl_daily_log - INFO - Retrieving email(s)
2023-12-28 03:50:45,872 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F28+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-28 03:50:45,872 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-28 03:50:55,953 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-28 03:50:55,954 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-28 03:50:55,972 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 4 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-28 04:50:01,795 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-28 04:50:01,795 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-28 04:50:01.795926

2023-12-28 04:50:01,796 - etl_daily_log - INFO - Stop date is set for: 2023/12/28

2023-12-28 04:50:01,796 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-28 04:50:01,796 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-28 04:50:01,796 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-28 04:50:01,797 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-28 04:50:01,798 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-28 04:50:01,798 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-28 04:50:01,798 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-28 04:50:01,799 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fdecc0fd2d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-28 04:50:11,812 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-28 04:50:11,814 - etl_daily_log - INFO - Retrieving email(s)
2023-12-28 04:50:11,816 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F28+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-28 04:50:11,816 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-28 04:50:21,888 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-28 04:50:21,888 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-28 04:50:21,920 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 5 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 05:50:01,833 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 05:50:01,834 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 05:50:01.834296

2023-12-31 05:50:01,834 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 05:50:01,834 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 05:50:01,835 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 05:50:01,835 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 05:50:01,835 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 05:50:01,838 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 05:50:01,838 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 05:50:01,839 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 05:50:01,840 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4da45054e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 05:50:11,897 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 05:50:11,907 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 05:50:11,912 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 05:50:11,912 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 05:50:22,008 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 05:50:22,009 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 05:50:22,040 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 6 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 06:50:02,256 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 06:50:02,256 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 06:50:02.256441

2023-12-31 06:50:02,256 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 06:50:02,257 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 06:50:02,257 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 06:50:02,257 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 06:50:02,257 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 06:50:02,259 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 06:50:02,259 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 06:50:02,259 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 06:50:02,260 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5e3101390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 06:50:12,285 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 06:50:12,291 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 06:50:12,297 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 06:50:12,298 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 06:50:22,398 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 06:50:22,399 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 06:50:22,415 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 7 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 07:50:02,284 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 07:50:02,284 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 07:50:02.284792

2023-12-31 07:50:02,284 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 07:50:02,285 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 07:50:02,285 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 07:50:02,285 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 07:50:02,286 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 07:50:02,287 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 07:50:02,287 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 07:50:02,287 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 07:50:02,288 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ffb9889faf0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 07:50:12,318 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 07:50:12,322 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 07:50:12,328 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 07:50:12,329 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 07:50:22,423 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 07:50:22,424 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 07:50:22,458 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 8 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 08:50:02,315 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 08:50:02,316 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 08:50:02.316007

2023-12-31 08:50:02,316 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 08:50:02,316 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 08:50:02,316 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 08:50:02,316 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 08:50:02,317 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 08:50:02,318 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 08:50:02,318 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 08:50:02,319 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 08:50:02,320 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe295e09420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 08:50:12,335 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 08:50:12,337 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 08:50:12,340 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 08:50:12,341 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 08:50:22,421 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 08:50:22,422 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 08:50:22,440 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 9 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 09:50:02,483 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 09:50:02,483 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 09:50:02.483394

2023-12-31 09:50:02,483 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 09:50:02,484 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 09:50:02,484 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 09:50:02,484 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 09:50:02,484 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 09:50:02,489 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 09:50:02,490 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 09:50:02,490 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 09:50:02,491 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f20811014e0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 09:50:12,506 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 09:50:12,508 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 09:50:12,510 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 09:50:12,510 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 09:50:22,584 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 09:50:22,585 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 09:50:22,601 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 10 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 10:50:02,530 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 10:50:02,531 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 10:50:02.531044

2023-12-31 10:50:02,531 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 10:50:02,531 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 10:50:02,531 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 10:50:02,532 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 10:50:02,532 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 10:50:02,534 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 10:50:02,534 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 10:50:02,535 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 10:50:02,536 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f82dcb9ba60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 10:50:12,559 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 10:50:12,563 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 10:50:12,569 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 10:50:12,569 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 10:50:22,661 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 10:50:22,661 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 10:50:22,687 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 11 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 11:50:02,399 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 11:50:02,399 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 11:50:02.399687

2023-12-31 11:50:02,399 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 11:50:02,400 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 11:50:02,400 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 11:50:02,400 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 11:50:02,400 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 11:50:02,402 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 11:50:02,402 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 11:50:02,402 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 11:50:02,403 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7efc8affd120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 11:50:12,415 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 11:50:12,417 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 11:50:12,419 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 11:50:12,419 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 11:50:22,498 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 11:50:22,499 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 11:50:22,522 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 12 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 12:50:01,736 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 12:50:01,736 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 12:50:01.736883

2023-12-31 12:50:01,737 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 12:50:01,737 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 12:50:01,737 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 12:50:01,737 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 12:50:01,738 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 12:50:01,739 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 12:50:01,739 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 12:50:01,739 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 12:50:01,740 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa19a1f5120>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 12:50:11,767 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 12:50:11,773 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 12:50:11,780 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 12:50:11,780 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 12:50:21,861 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 12:50:21,862 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 12:50:21,896 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 13 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 13:50:01,795 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 13:50:01,795 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 13:50:01.795817

2023-12-31 13:50:01,796 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 13:50:01,796 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 13:50:01,796 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 13:50:01,796 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 13:50:01,797 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 13:50:01,798 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 13:50:01,798 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 13:50:01,799 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 13:50:01,800 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f9aad0f50f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 13:50:11,820 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 13:50:11,827 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 13:50:11,835 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 13:50:11,836 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 13:50:21,928 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 13:50:21,929 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 13:50:21,961 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 14 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 14:50:01,803 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 14:50:01,803 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 14:50:01.803300

2023-12-31 14:50:01,803 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 14:50:01,804 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 14:50:01,804 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 14:50:01,804 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 14:50:01,804 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 14:50:01,806 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 14:50:01,806 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 14:50:01,806 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 14:50:01,807 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b8be01210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 14:50:11,832 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 14:50:11,838 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 14:50:11,843 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 14:50:11,843 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 14:50:21,927 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 14:50:21,927 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 14:50:21,959 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 15 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 15:50:01,851 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 15:50:01,852 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 15:50:01.852152

2023-12-31 15:50:01,852 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 15:50:01,852 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 15:50:01,852 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 15:50:01,852 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 15:50:01,853 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 15:50:01,855 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 15:50:01,855 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 15:50:01,856 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 15:50:01,857 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5ba2cfcfd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 15:50:11,875 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 15:50:11,878 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 15:50:11,883 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 15:50:11,884 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 15:50:21,976 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 15:50:21,977 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 15:50:22,011 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 16 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 16:50:01,949 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 16:50:01,949 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 16:50:01.949853

2023-12-31 16:50:01,950 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 16:50:01,950 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 16:50:01,950 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 16:50:01,950 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 16:50:01,951 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 16:50:01,952 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 16:50:01,953 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 16:50:01,953 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 16:50:01,955 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f6306f09480>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 16:50:11,983 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 16:50:11,989 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 16:50:11,993 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 16:50:11,994 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 16:50:22,082 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 16:50:22,083 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 16:50:22,108 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 17 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 17:50:02,004 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 17:50:02,004 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 17:50:02.004701

2023-12-31 17:50:02,004 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 17:50:02,005 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 17:50:02,008 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 17:50:02,010 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 17:50:02,011 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 17:50:02,013 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 17:50:02,013 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 17:50:02,013 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 17:50:02,015 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7eff4a8fd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 17:50:12,037 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 17:50:12,043 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 17:50:12,050 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 17:50:12,050 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 17:50:22,151 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 17:50:22,152 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 17:50:22,185 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 18 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 18:50:01,965 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 18:50:01,966 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 18:50:01.966135

2023-12-31 18:50:01,966 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 18:50:01,966 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 18:50:01,966 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 18:50:01,967 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 18:50:01,967 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 18:50:01,968 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 18:50:01,968 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 18:50:01,969 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 18:50:01,970 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f74cad01420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 18:50:11,993 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 18:50:12,000 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 18:50:12,009 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 18:50:12,009 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 18:50:22,105 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 18:50:22,105 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 18:50:22,138 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 19 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 19:50:02,045 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 19:50:02,045 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 19:50:02.045561

2023-12-31 19:50:02,045 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 19:50:02,046 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 19:50:02,046 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 19:50:02,046 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 19:50:02,047 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 19:50:02,049 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 19:50:02,049 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 19:50:02,050 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 19:50:02,052 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fabb7b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 19:50:12,075 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 19:50:12,081 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 19:50:12,091 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 19:50:12,091 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 19:50:22,196 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 19:50:22,196 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 19:50:22,212 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 20 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 20:50:02,156 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 20:50:02,156 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 20:50:02.156607

2023-12-31 20:50:02,156 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 20:50:02,157 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 20:50:02,157 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 20:50:02,157 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 20:50:02,157 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 20:50:02,160 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 20:50:02,160 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 20:50:02,160 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 20:50:02,161 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe4c8493b20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 20:50:12,189 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 20:50:12,196 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 20:50:12,201 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 20:50:12,202 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 20:50:22,287 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 20:50:22,288 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 20:50:22,322 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 21 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 21:50:02,215 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 21:50:02,215 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 21:50:02.215414

2023-12-31 21:50:02,215 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 21:50:02,215 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 21:50:02,216 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 21:50:02,216 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 21:50:02,216 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 21:50:02,217 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 21:50:02,218 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 21:50:02,218 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 21:50:02,219 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f96f8ba7d60>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 21:50:12,246 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 21:50:12,253 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 21:50:12,260 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 21:50:12,260 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 21:50:22,354 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 21:50:22,355 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 21:50:22,379 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 22 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 22:50:02,248 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 22:50:02,248 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 22:50:02.248355

2023-12-31 22:50:02,248 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 22:50:02,248 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 22:50:02,249 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 22:50:02,249 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 22:50:02,249 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 22:50:02,250 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 22:50:02,250 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 22:50:02,251 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 22:50:02,252 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4df79f5030>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 22:50:12,276 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 22:50:12,284 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 22:50:12,290 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 22:50:12,290 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 22:50:22,380 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 22:50:22,380 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 22:50:22,418 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 23 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2023-12-31 23:50:02,254 - src.utils.file_paths - INFO - Read mc_config.ini successful
2023-12-31 23:50:02,254 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2023-12-31 23:50:02.254408

2023-12-31 23:50:02,254 - etl_daily_log - INFO - Stop date is set for: 2023/12/31

2023-12-31 23:50:02,255 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 23:50:02,255 - etl_daily_log - INFO - Loading app data from JSON file.
2023-12-31 23:50:02,255 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2023-12-31 23:50:02,255 - etl_daily_log - INFO - Read mc_config.ini successful
2023-12-31 23:50:02,257 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2023-12-31 23:50:02,257 - etl_daily_log - INFO - Trying to refresh credentials...
2023-12-31 23:50:02,257 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 23:50:02,258 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7faf9d105630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2023-12-31 23:50:12,281 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2023-12-31 23:50:12,289 - etl_daily_log - INFO - Retrieving email(s)
2023-12-31 23:50:12,295 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2023%2F12%2F31+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2023-12-31 23:50:12,295 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2023-12-31 23:50:22,386 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2023-12-31 23:50:22,387 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2023-12-31 23:50:22,421 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 0 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 00:50:02,267 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 00:50:02,267 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 00:50:02.267652

2024-01-01 00:50:02,267 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 00:50:02,268 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 00:50:02,268 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 00:50:02,268 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 00:50:02,268 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 00:50:02,270 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 00:50:02,270 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 00:50:02,270 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 00:50:02,271 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bdcafd390>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 00:50:12,300 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 00:50:12,306 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 00:50:12,315 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 00:50:12,316 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 00:50:22,414 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 00:50:22,415 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 00:50:22,440 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 1 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 01:50:02,337 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 01:50:02,337 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 01:50:02.337955

2024-01-01 01:50:02,338 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 01:50:02,338 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 01:50:02,338 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 01:50:02,338 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 01:50:02,339 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 01:50:02,341 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 01:50:02,341 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 01:50:02,341 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 01:50:02,342 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4bc2e09750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 01:50:12,369 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 01:50:12,377 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 01:50:12,382 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 01:50:12,382 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 01:50:22,469 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 01:50:22,469 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 01:50:22,499 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 2 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 02:50:02,350 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 02:50:02,350 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 02:50:02.350761

2024-01-01 02:50:02,350 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 02:50:02,351 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 02:50:02,351 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 02:50:02,351 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 02:50:02,352 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 02:50:02,353 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 02:50:02,353 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 02:50:02,353 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 02:50:02,354 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f475fc016f0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 02:50:12,378 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 02:50:12,384 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 02:50:12,394 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 02:50:12,395 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 02:50:22,495 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 02:50:22,496 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 02:50:22,526 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 3 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 03:50:02,364 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 03:50:02,364 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 03:50:02.364460

2024-01-01 03:50:02,364 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 03:50:02,365 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 03:50:02,365 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 03:50:02,365 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 03:50:02,365 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 03:50:02,367 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 03:50:02,367 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 03:50:02,367 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 03:50:02,368 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa1e81f1090>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 03:50:12,378 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 03:50:12,379 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 03:50:12,382 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 03:50:12,382 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 03:50:22,460 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 03:50:22,460 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 03:50:22,493 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 4 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 04:50:02,422 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 04:50:02,423 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 04:50:02.423084

2024-01-01 04:50:02,423 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 04:50:02,423 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 04:50:02,423 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 04:50:02,424 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 04:50:02,424 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 04:50:02,425 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 04:50:02,425 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 04:50:02,426 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 04:50:02,427 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f818a3f8fa0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 04:50:12,440 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 04:50:12,442 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 04:50:12,444 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 04:50:12,444 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 04:50:22,521 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 04:50:22,521 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 04:50:22,544 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 5 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 05:50:02,439 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 05:50:02,440 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 05:50:02.440001

2024-01-01 05:50:02,440 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 05:50:02,440 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 05:50:02,440 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 05:50:02,440 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 05:50:02,441 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 05:50:02,442 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 05:50:02,442 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 05:50:02,442 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 05:50:02,444 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7ff227205420>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 05:50:12,455 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 05:50:12,457 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 05:50:12,459 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 05:50:12,459 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 05:50:22,536 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 05:50:22,537 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 05:50:22,570 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 6 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 06:50:02,318 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 06:50:02,319 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 06:50:02.319262

2024-01-01 06:50:02,319 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 06:50:02,319 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 06:50:02,320 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 06:50:02,320 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 06:50:02,320 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 06:50:02,322 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 06:50:02,322 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 06:50:02,322 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 06:50:02,324 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4645afd210>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 06:50:12,343 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 06:50:12,348 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 06:50:12,356 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 06:50:12,356 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 06:50:22,576 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 06:50:22,576 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 06:50:22,608 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 7 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 07:50:02,182 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 07:50:02,182 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 07:50:02.182741

2024-01-01 07:50:02,183 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 07:50:02,183 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 07:50:02,184 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 07:50:02,184 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 07:50:02,185 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 07:50:02,188 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 07:50:02,188 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 07:50:02,188 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 07:50:02,192 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f5b7a009780>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 07:50:12,217 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 07:50:12,223 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 07:50:12,230 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 07:50:12,231 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 07:50:22,392 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 07:50:22,392 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 07:50:22,422 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 8 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 08:50:01,800 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 08:50:01,800 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 08:50:01.800723

2024-01-01 08:50:01,800 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 08:50:01,801 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 08:50:01,801 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 08:50:01,801 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 08:50:01,802 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 08:50:01,804 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 08:50:01,804 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 08:50:01,805 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 08:50:01,806 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe573893a30>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 08:50:11,837 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 08:50:11,844 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 08:50:11,849 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 08:50:11,849 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 08:50:21,965 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 08:50:21,965 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 08:50:21,992 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 9 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 09:50:02,451 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 09:50:02,451 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 09:50:02.451785

2024-01-01 09:50:02,451 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 09:50:02,452 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 09:50:02,452 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 09:50:02,452 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 09:50:02,453 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 09:50:02,455 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 09:50:02,455 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 09:50:02,455 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 09:50:02,464 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7aa2ff8f40>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 09:50:12,480 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 09:50:12,482 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 09:50:12,484 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 09:50:12,484 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 09:50:22,580 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 09:50:22,581 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 09:50:22,616 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 10 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 10:50:02,505 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 10:50:02,506 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 10:50:02.506125

2024-01-01 10:50:02,506 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 10:50:02,506 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 10:50:02,506 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 10:50:02,506 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 10:50:02,507 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 10:50:02,508 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 10:50:02,508 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 10:50:02,509 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 10:50:02,510 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe2f0b01330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 10:50:12,526 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 10:50:12,528 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 10:50:12,531 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 10:50:12,532 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 10:50:22,616 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 10:50:22,617 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 10:50:22,654 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 11 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 11:50:02,284 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 11:50:02,285 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 11:50:02.285239

2024-01-01 11:50:02,285 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 11:50:02,285 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 11:50:02,286 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 11:50:02,286 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 11:50:02,286 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 11:50:02,287 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 11:50:02,288 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 11:50:02,288 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 11:50:02,289 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8dd0e05330>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 11:50:12,302 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 11:50:12,304 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 11:50:12,307 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 11:50:12,307 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 11:50:22,392 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 11:50:22,392 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 11:50:22,421 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 12 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 12:50:02,507 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 12:50:02,507 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 12:50:02.507941

2024-01-01 12:50:02,508 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 12:50:02,508 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 12:50:02,508 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 12:50:02,508 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 12:50:02,509 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 12:50:02,510 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 12:50:02,510 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 12:50:02,510 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 12:50:02,512 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
--- Logging error ---
Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 193, in __call__
    response = self.session.request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 41, in get_google_credentials
    creds.refresh(Request())
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/credentials.py", line 335, in refresh
    ) = reauth.refresh_grant(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/reauth.py", line 324, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 213, in _token_endpoint_request_no_throw
    request_succeeded, response_data, retryable_error = _perform_request()
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/oauth2/_client.py", line 189, in _perform_request
    response = request(
  File "/home/oseloka/pyprojects/maplecourt_py/venv_mc/lib/python3.10/site-packages/google/auth/transport/requests.py", line 199, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/logging/__init__.py", line 1100, in emit
    msg = self.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 943, in format
    return fmt.format(record)
  File "/usr/lib/python3.10/logging/__init__.py", line 678, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.10/logging/__init__.py", line 368, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 162, in <module>
    records = extract_mc_transaction(sender, start_date, stop_date, subject, logger)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/expenses_transform_load_daily.py", line 30, in extract_mc_transaction
    email_data = read_email(sender, start_date, stop_date, subject, logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/comms.py", line 60, in read_email
    service = get_google_credentials(logger_instance)
  File "/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/utils/credentials.py", line 46, in get_google_credentials
    logger_instance.error("Failed to refresh credentials:", e)
Message: 'Failed to refresh credentials:'
Arguments: (TransportError(ConnectionError(MaxRetryError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f7cfd80d630>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))"))),)
2024-01-01 12:50:12,527 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 12:50:12,528 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 12:50:12,531 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 12:50:12,531 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 12:50:22,621 - etl_daily_log - ERROR - Error while reading email: Unable to find the server at oauth2.googleapis.com
2024-01-01 12:50:22,621 - etl_daily_log - ERROR - Rescheduling process due to error retrieving email data:
'NoneType' object is not iterable
2024-01-01 12:50:22,639 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
50 13 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
/home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl
2024-01-01 13:50:02,183 - src.utils.file_paths - INFO - Read mc_config.ini successful
2024-01-01 13:50:02,183 - etl_daily_log - INFO - PROCESS RUN TIMESTAMP...........................................................................: 2024-01-01 13:50:02.183689

2024-01-01 13:50:02,183 - etl_daily_log - INFO - Stop date is set for: 2024/01/01

2024-01-01 13:50:02,184 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 13:50:02,184 - etl_daily_log - INFO - Loading app data from JSON file.
2024-01-01 13:50:02,184 - etl_daily_log - INFO - Start date is set for: 2023/12/24

2024-01-01 13:50:02,185 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 13:50:02,187 - etl_daily_log - WARNING - Failed to obtain valid creddentials
2024-01-01 13:50:02,187 - etl_daily_log - INFO - Trying to refresh credentials...
2024-01-01 13:50:02,187 - google.auth.transport.requests - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2024-01-01 13:50:02,188 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2024-01-01 13:50:08,420 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2024-01-01 13:50:08,421 - etl_daily_log - INFO - Credentials refreshed successfully.

2024-01-01 13:50:08,425 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2024-01-01 13:50:08,428 - etl_daily_log - INFO - Retrieving email(s)
2024-01-01 13:50:08,431 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?q=from%3A%27GeNS%40gtbank.com%27+after%3A2023%2F12%2F24+before%3A2024%2F01%2F01+subject%3A%27GeNS+Transaction+%2A%27&alt=json
2024-01-01 13:50:20,120 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/18cc23f17cb1f9a7?format=full&alt=json
2024-01-01 13:50:20,529 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/18cc23e20177c10d?format=full&alt=json
2024-01-01 13:50:20,986 - googleapiclient.discovery - DEBUG - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/18cbe83b94148279?format=full&alt=json
2024-01-01 13:50:21,509 - etl_daily_log - INFO - Retrieved 3 email(s)
2024-01-01 13:50:21,510 - etl_daily_log - INFO - Records Extracted, Transformed and ready for Loading...

2024-01-01 13:50:21,510 - etl_daily_log - INFO - Inserting records into maplecourt.Cashflow db table...
2024-01-01 13:50:21,513 - etl_daily_log - INFO - MySQL process is already running.
2024-01-01 13:50:21,654 - etl_daily_log - INFO - MySQL connection pool created.
2024-01-01 13:50:21,655 - etl_daily_log - INFO - Connected to mc_pool pool successfully

2024-01-01 13:50:21,656 - etl_daily_log - INFO - Event scheduler is started

2024-01-01 13:50:21,739 - etl_daily_log - INFO - ETL complete!
Total of 3 records where successfully inserted

2024-01-01 13:50:21,740 - etl_daily_log - INFO - Read mc_config.ini successful
2024-01-01 13:50:21,741 - etl_daily_log - INFO - Writing app data to JSON file.
2024-01-01 13:50:21,741 - etl_daily_log - INFO - App data written to JSON file.
2024-01-01 13:50:21,742 - etl_daily_log - INFO - Next ETL operation has been scheduled for tomorrow.
2024-01-01 13:50:21,745 - etl_daily_log - INFO - Database cursor and connection are closed
2024-01-01 13:50:21,768 - etl_daily_log - INFO - The 'etl_daily' cron job has been successfully reset as follows:
0 11 * * * . /home/oseloka/.bash_profile; /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/src/mgt_data_etl/execute_etl_daily.sh >> /home/oseloka/pyprojects/maplecourt_py/MapleCourt_propertyMgt/app_logs/etl_daily.txt 2>&1 # etl_daily
